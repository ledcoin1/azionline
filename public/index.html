<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>–û–Ω–ª–∞–π–Ω –µ–∫—ñ –æ–π—ã–Ω—à—ã</title>
<script src="/socket.io/socket.io.js"></script>

<style>
body {
  font-family: Arial, sans-serif;
  background: #2e7d32;
  color: white;
  margin: 0;
  padding: 0;
  text-align: center;
}

h1 { margin-top: 20px; }

/* Lobby */
#lobby { margin-top: 50px; }

/* Game table */
#game {
  display: none;
  position: relative;
  width: 900px;
  height: 520px;
  margin: 20px auto;
  background: radial-gradient(circle, #2e7d32 0%, #1b5e20 70%);
  border-radius: 25px;
  box-shadow: 0 0 30px #000;
}

/* Opponent area */
#opponent {
  margin-top: 20px;
}

/* Cards */
.opponent-card, .player-card {
  width: 90px;
  height: 140px;
  border-radius: 12px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  margin: 10px;
  font-size: 30px;
  box-shadow: 0 0 10px #000;
}

.opponent-card {
  background: #fff;
  color: black;
  transform: rotateX(180deg);
}

.player-card {
  background: #ccc;
  color: black;
}

/* Player cards */
#player-cards {
  position: absolute;
  bottom: 20px;
  width: 100%;
}

/* Bet UI */
#bet-area {
  margin-top: 15px;
}

button {
  padding: 10px 18px;
  font-size: 16px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
  background: #4caf50;
  color: white;
}
button:hover { background: #66bb6a; }

input {
  width: 70px;
  padding: 6px;
  font-size: 16px;
  border-radius: 6px;
  border: none;
}
</style>
</head>

<body>

<h1>üÉè –û–Ω–ª–∞–π–Ω –æ–π—ã–Ω</h1>

<!-- LOBBY -->
<div id="lobby">
  <div id="info">–û–π—ã–Ω“ì–∞ “õ–æ—Å—ã–ª—É “Ø—à—ñ–Ω –±–∞—Ç—ã—Ä–º–∞–Ω—ã –±–∞—Å—ã“£—ã–∑</div>
  <button id="joinBtn">–û–π—ã–Ω“ì–∞ “õ–æ—Å—ã–ª—É</button>
</div>

<!-- GAME -->
<div id="game">
  <div id="infoGame"></div>

  <div id="opponent"></div>

  <div id="player-cards"></div>

  <div id="bet-area"></div>
</div>

<script>
// ===== DOM =====
const joinBtn = document.getElementById("joinBtn");
const info = document.getElementById("info");
const lobby = document.getElementById("lobby");
const game = document.getElementById("game");
const infoGame = document.getElementById("infoGame");
const opponentDiv = document.getElementById("opponent");
const playerCardsDiv = document.getElementById("player-cards");
const betArea = document.getElementById("bet-area");

// ===== SOCKET =====
const socket = io();
let myId;

// ===== JOIN GAME =====
joinBtn.onclick = () => {
  myId = Math.floor(Math.random() * 1000);
  socket.emit("joinGame", { userId: myId });
  info.innerText = "‚è≥ –°–µ—Ä–≤–µ—Ä–≥–µ “õ–æ—Å—ã–ª—É–¥–∞...";
  joinBtn.disabled = true;
};

// ===== SERVER MESSAGE =====
socket.on("message", msg => {
  info.innerText = msg;
});

// ===== OPPONENT FOUND =====
socket.on("opponentFound", ({ opponentId }) => {
  lobby.style.display = "none";
  game.style.display = "block";

  infoGame.innerText = `“ö–∞—Ä—Å—ã–ª–∞—Å —Ç–∞–±—ã–ª–¥—ã: ${opponentId}`;

  // Opponent cards
  opponentDiv.innerHTML = "";
  for (let i = 0; i < 3; i++) {
    const c = document.createElement("div");
    c.className = "opponent-card";
    c.innerText = "üÇ†";
    opponentDiv.appendChild(c);
  }

  // Player cards
  playerCardsDiv.innerHTML = "";
  for (let i = 0; i < 3; i++) {
    const c = document.createElement("div");
    c.className = "player-card";
    c.innerText = "üÇ†";
    playerCardsDiv.appendChild(c);
  }

  // Bet UI (–±—ñ—Ä—ñ–Ω—à—ñ –æ–π—ã–Ω—à—ã “Ø—à—ñ–Ω)
  betArea.innerHTML = `
    <div>
      –°—Ç–∞–≤–∫–∞:
      <input type="number" id="betInput" min="25" max="150" value="25">
      <button id="betBtn">–ñ—ñ–±–µ—Ä—É</button>
    </div>
  `;

  document.getElementById("betBtn").onclick = () => {
    const bet = Number(document.getElementById("betInput").value);
    socket.emit("playerBet", { bet });
    betArea.innerHTML = "‚è≥ –°—Ç–∞–≤–∫–∞ –∂—ñ–±–µ—Ä—ñ–ª–¥—ñ, “õ–∞—Ä—Å—ã–ª–∞—Å —à–µ—à—ñ–º “õ–∞–±—ã–ª–¥–∞—É–¥–∞...";
  };
});

// ===== RECEIVE OPPONENT BET =====
socket.on("opponentBet", ({ bet }) => {
  betArea.innerHTML = `
    <div>
      “ö–∞—Ä—Å—ã–ª–∞—Å —Å—Ç–∞–≤–∫–∞ “õ–æ–π–¥—ã: <b>${bet * 2}</b>
      <br><br>
      <button id="readyBtn">–ì–æ—Ç–æ–≤</button>
      <button id="foldBtn">–û—Ç–±–æ–π</button>
    </div>
  `;

  document.getElementById("readyBtn").onclick = () => {
    socket.emit("playerReady", { ready: true });
    betArea.innerHTML = "‚úÖ –°—ñ–∑ –≥–æ—Ç–æ–≤ –±–∞—Å—Ç—ã“£";
  };

  document.getElementById("foldBtn").onclick = () => {
    socket.emit("playerReady", { ready: false });
    betArea.innerHTML = "‚ùå –°—ñ–∑ –æ—Ç–±–æ–π –±–∞—Å—Ç—ã“£";
  };
});

// ===== RECEIVE READY / FOLD =====
socket.on("opponentReady", ({ ready }) => {
  alert(`“ö–∞—Ä—Å—ã–ª–∞—Å ${ready ? "–ì–û–¢–û–í" : "–û–¢–ë–û–ô"} –±–∞—Å—Ç—ã`);
});
</script>

</body>
</html>
