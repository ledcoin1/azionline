<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>3 –û–π—ã–Ω—à—ã –ö–æ–º–Ω–∞—Ç–∞</title>
  <script src="/socket.io/socket.io.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f0f2f5;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
      margin: 0;
      padding: 20px;
    }
    .container {
      width: 500px;
      background: #fff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }
    h2 { text-align: center; }
    input[type=text] {
      width: 70%;
      padding: 10px;
      margin-right: 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    button {
      padding: 10px 15px;
      border: none;
      border-radius: 6px;
      background: #4caf50;
      color: #fff;
      cursor: pointer;
      font-weight: bold;
    }
    button:hover {
      background: #45a049;
    }
    ul { list-style: none; padding: 0; }
    li { padding: 5px 0; }
    .log { margin-top: 15px; background: #eef; padding: 10px; border-radius: 8px; max-height: 150px; overflow-y: auto; }
    .status { font-weight: bold; color: #333; margin-top: 10px; text-align: center; }
  </style>
</head>
<body>
  <div class="container">
    <h2>3 –û–π—ã–Ω—à—ã –ö–æ–º–Ω–∞—Ç–∞</h2>

    <div>
      <input type="text" id="playerName" placeholder="–ê—Ç—ã“£—ã–∑">
      <button id="joinBtn">Join</button>
    </div>

    <div class="status" id="roomStatus">–ö–µ–∑–µ–∫ –∫“Ø—Ç—ñ–ø —Ç“±—Ä...</div>

    <h3>–û–π—ã–Ω—à—ã–ª–∞—Ä:</h3>
    <ul id="playersList"></ul>

    <div class="log" id="log"></div>
  </div>

  <script>
    const socket = io();

    const joinBtn = document.getElementById("joinBtn");
    const playerNameInput = document.getElementById("playerName");
    const playersList = document.getElementById("playersList");
    const log = document.getElementById("log");
    const roomStatus = document.getElementById("roomStatus");

    joinBtn.addEventListener("click", () => {
      const name = playerNameInput.value.trim();
      if (!name) return alert("–ê—Ç—ã“£—ã–∑–¥—ã –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑!");
      socket.emit("join", name);
      joinBtn.disabled = true;
      playerNameInput.disabled = true;
      roomStatus.textContent = "–ö–µ–∑–µ–∫ –∫“Ø—Ç—ñ–ø —Ç“±—Ä...";
    });

    socket.on("room_update", (data) => {
      playersList.innerHTML = "";
      data.players.forEach(p => {
        const li = document.createElement("li");
        li.textContent = `${p.name} (${p.balance || 1000})`;
        playersList.appendChild(li);
      });

      if (data.status === "started") {
        roomStatus.textContent = "–û–π—ã–Ω –±–∞—Å—Ç–∞–ª–¥—ã!";
      } else {
        roomStatus.textContent = `–ö–µ–∑–µ–∫ –∫“Ø—Ç—ñ–ø —Ç“±—Ä... (${data.players.length}/3)`;
      }
    });

    socket.on("game_started", (data) => {
      roomStatus.textContent = "üî• –û–π—ã–Ω –±–∞—Å—Ç–∞–ª–¥—ã!";
      logMessage("–ë–∞—Ä–ª—ã“õ 3 –æ–π—ã–Ω—à—ã “õ–æ—Å—ã–ª–¥—ã. –û–π—ã–Ω –±–∞—Å—Ç–∞–ª–¥—ã!");
    });

    socket.on("log_update", (data) => {
      logMessage(data.msg);
    });

    function logMessage(msg) {
      const div = document.createElement("div");
      div.textContent = msg;
      log.appendChild(div);
      log.scrollTop = log.scrollHeight;
    }
  </script>
</body>
</html>
