<!DOCTYPE html>
<html lang="kk">
<head>
  <meta charset="UTF-8">
  <title>3 Ойыншы Тест</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    .player { border: 1px solid #ccc; padding: 10px; margin-bottom: 15px; }
    button { margin: 5px; }
    input { width: 60px; }
  </style>
</head>
<body>

<h1>3 Ойыншы Тест</h1>

<div class="player" id="player1">
  <h2>1-ойыншы</h2>
  Ставка: <input type="number" id="bet1" min="50" max="150" value="50">
  <button onclick="firstPlayerBet()">Ставка жіберу</button>
  <div id="log1"></div>
</div>

<div class="player" id="player2">
  <h2>2-ойыншы</h2>
  <button onclick="secondPlayerAccept()">Келісемін</button>
  <button onclick="secondPlayerFold()">Отбой</button>
  <div id="log2"></div>
</div>

<div class="player" id="player3">
  <h2>3-ойыншы</h2>
  <button onclick="thirdPlayerAccept()">Келісемін</button>
  <button onclick="thirdPlayerFold()">Отбой</button>
  <div id="log3"></div>
</div>

<script src="/socket.io/socket.io.js"></script>
<script>
  const socket = io();

  // Бірінші ойыншының аты
  const playerName = "TestPlayer";

  // Join сигнал
  socket.emit("join", playerName);

  // --- 1-ойыншы ---
  function firstPlayerBet() {
    const bet = parseInt(document.getElementById("bet1").value);
    socket.emit("first_player_bet", { bet });
    log(1, `Ставка жіберілді: ${bet}`);
  }

  socket.on("your_turn", data => log(1, data.message));

  socket.on("first_player_bet_doubled", data => {
    log(2, `2-ойыншыға ставка келді: ${data.bet}`);
  });

  // --- 2-ойыншы ---
  function secondPlayerAccept() {
    socket.emit("second_player_accept");
    log(2, "2-ойыншы: Келісемін жіберілді");
  }

  function secondPlayerFold() {
    socket.emit("second_player_fold");
    log(2, "2-ойыншы: Отбой жіберілді");
  }

  socket.on("second_player_bet_doubled_again", data => {
    log(3, `3-ойыншыға ставка келді (2-ойыншы келіссе): ${data.bet}`);
  });

  socket.on("second_player_folded_bet", data => {
    log(3, `3-ойыншыға ставка келді (2-ойыншы отбой): ${data.bet}`);
  });

  // --- 3-ойыншы ---
  function thirdPlayerAccept() {
    socket.emit("third_player_accept");
    log(3, "3-ойыншы: Келісемін жіберілді");
  }

  function thirdPlayerFold() {
    socket.emit("third_player_fold");
    log(3, "3-ойыншы: Отбой жіберілді");
  }

  // --- Журналға жазу функциясы ---
  function log(player, message) {
    const logDiv = document.getElementById(`log${player}`);
    const p = document.createElement("p");
    p.textContent = message;
    logDiv.appendChild(p);
  }
</script>

</body>
</html>
