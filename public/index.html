<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>3-–æ–π—ã–Ω—à—ã –æ–π—ã–Ω</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: #fff;
    margin: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    flex-direction: column;
  }

  .container {
    background: rgba(0,0,0,0.6);
    padding: 40px 50px;
    border-radius: 20px;
    box-shadow: 0 0 30px rgba(0,0,0,0.5);
    text-align: center;
    width: 400px;
  }

  h1 {
    margin-bottom: 20px;
  }

  input, button {
    padding: 10px 15px;
    margin: 10px 0;
    border-radius: 10px;
    border: none;
    outline: none;
    font-size: 16px;
  }

  input { width: 80%; }
  button {
    background: #ff6b81;
    color: #fff;
    cursor: pointer;
    transition: 0.3s;
  }
  button:hover { background: #ff4757; }

  .log {
    margin-top: 20px;
    background: rgba(255,255,255,0.1);
    padding: 10px;
    border-radius: 10px;
    max-height: 200px;
    overflow-y: auto;
    text-align: left;
  }

  .turn {
    margin-top: 20px;
    font-weight: bold;
    font-size: 18px;
    color: #ffd700;
  }

  #choiceDiv {
    margin-top: 20px;
    display: none;
  }
</style>
</head>
<body>
  <div class="container">
    <h1>3-–æ–π—ã–Ω—à—ã –æ–π—ã–Ω</h1>
    <input type="text" id="nameInput" placeholder="–ê—Ç—ã“£–¥—ã –µ–Ω–≥—ñ–∑">
    <button id="joinBtn">“ö–æ—Å—ã–ª—É</button>

    <div class="turn" id="turnText">–ö–µ–∑–µ–∫ –∫“Ø—Ç—ñ–ª—É–¥–µ...</div>

    <div id="choiceDiv">
      <input type="number" id="numberInput" min="50" max="150" placeholder="50‚Äì150 –∞—Ä–∞—Å—ã–Ω–¥–∞ —Å–∞–Ω">
      <button id="sendBtn">–ñ—ñ–±–µ—Ä—É</button>
    </div>

    <div class="log" id="log"></div>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script>
    const socket = io();

    const joinBtn = document.getElementById("joinBtn");
    const nameInput = document.getElementById("nameInput");
    const logDiv = document.getElementById("log");
    const turnText = document.getElementById("turnText");

    const choiceDiv = document.getElementById("choiceDiv");
    const numberInput = document.getElementById("numberInput");
    const sendBtn = document.getElementById("sendBtn");

    // “ö–æ—Å—ã–ª—É
    joinBtn.addEventListener("click", () => {
      const name = nameInput.value.trim();
      if (!name) return alert("–ê—Ç—ã“£–¥—ã –µ–Ω–≥—ñ–∑!");
      socket.emit("join", name);
      addLog(`‚úÖ –°–µ–Ω “õ–æ—Å—ã–ª–¥—ã“£: ${name}`);
      joinBtn.disabled = true;
      nameInput.disabled = true;
    });

    // –ö–æ–º–Ω–∞—Ç–∞ –∂–∞“£–∞—Ä—Ç—É—ã
    socket.on("room_update", (data) => {
      addLog(`üë• –ö–æ–º–Ω–∞—Ç–∞ –∂–∞“£–∞—Ä—Ç—ã–ª–¥—ã: ${data.players.map(p => p.name).join(", ")} (${data.players.length}/3)`);
    });

    // –û–π—ã–Ω –±–∞—Å—Ç–∞–ª–¥—ã
    socket.on("game_started", (data) => {
      addLog("üî• –û–π—ã–Ω –±–∞—Å—Ç–∞–ª–¥—ã!");
      addLog(`–û–π—ã–Ω—à—ã–ª–∞—Ä: ${data.players.map(p => p.name).join(", ")}`);
      turnText.textContent = "–ö–µ–∑–µ–∫ –∫“Ø—Ç—ñ–ª—É–¥–µ...";
    });

    // –°–µ–Ω—ñ“£ –∫–µ–∑–µ–≥—ñ“£
    socket.on("your_turn", (data) => {
      turnText.textContent = data.message || "–°–µ–Ω—ñ“£ –∫–µ–∑–µ–≥—ñ“£!";
      addLog(`‚ö° –°–∞“ì–∞–Ω —Å–∏–≥–Ω–∞–ª –∫–µ–ª–¥—ñ: ${data.message || "–°–µ–Ω—ñ“£ –∫–µ–∑–µ–≥—ñ“£!"}`);
      choiceDiv.style.display = "block";
    });

    // –ñ–∞—É–∞–ø –∂—ñ–±–µ—Ä—É
    sendBtn.addEventListener("click", () => {
      const number = parseInt(numberInput.value);
      if (isNaN(number) || number < 50 || number > 150) {
        return alert("50‚Äì150 –∞—Ä–∞–ª—ã“ì—ã–Ω–¥–∞ —Å–∞–Ω —Ç–∞“£–¥–∞!");
      }
      socket.emit("player_choice", { number });
      addLog(`‚úÖ –°–µ–Ω —Ç–∞“£–¥–∞–¥—ã“£: ${number}`);
      choiceDiv.style.display = "none";
      numberInput.value = "";
      turnText.textContent = "–ö–µ–∑–µ–∫ –∫“Ø—Ç—ñ–ª—É–¥–µ...";
    });

    // –õ–æ–≥“õ–∞ “õ–æ—Å—É —Ñ—É–Ω–∫—Ü–∏—è—Å—ã
    function addLog(msg) {
      const p = document.createElement("p");
      p.textContent = msg;
      logDiv.appendChild(p);
      logDiv.scrollTop = logDiv.scrollHeight;
    }
  </script>
</body>
</html>
