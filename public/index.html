<!DOCTYPE html>
<html lang="kk">
<head>
  <meta charset="UTF-8">
  <title>Card Game</title>

  <!-- Socket.IO клиент кітапханасы -->
  <script src="/socket.io/socket.io.js"></script>

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #111;
      color: #fff;
      text-align: center;
      padding-top: 40px;
    }

    button {
      padding: 10px 20px;
      margin: 5px;
      font-size: 16px;
      cursor: pointer;
    }

    #game {
      display: none;
    }

    #log {
      margin-top: 20px;
      min-height: 100px;
      background: #222;
      padding: 10px;
    }
  </style>
</head>
<body>

  <!-- JOIN ЭКРАН -->
  <div id="join">
    <h2>Онлайн карта ойыны</h2>
    <input id="userId" placeholder="User ID енгіз" />
    <br><br>
    <button onclick="joinGame()">Ойынға кіру</button>
  </div>

  <!-- GAME ЭКРАН -->
  <div id="game">
    <h2 id="status">Ойын басталды</h2>

    <button onclick="sendBet(100)">Ставка 100</button>
    <button onclick="sendBet(500)">Ставка 500</button>

    <br><br>

    <button onclick="sendReady(true)">ГОТОВ</button>
    <button onclick="sendReady(false)">ОТБОЙ</button>
  </div>

  <div id="log"></div>

  <script>
    // ===== SOCKET ҚОСЫЛУ =====
    const socket = io();

    // ===== ОЙЫНҒА КІРУ =====
    function joinGame() {
      const userId = document.getElementById("userId").value;
      if (!userId) return alert("User ID енгіз!");

      socket.emit("joinGame", { userId });
    }

    // ===== СТАВКА ЖІБЕРУ =====
    function sendBet(bet) {
      socket.emit("playerBet", { bet });
      log("Сен ставка қойдың: " + bet);
    }

    // ===== ГОТОВ / ОТБОЙ =====
    function sendReady(ready) {
      socket.emit("playerReady", { ready });
      log("Сен таңдау жасадың: " + (ready ? "ГОТОВ" : "ОТБОЙ"));
    }

    // ===== СЕРВЕРДЕН КЕЛЕТІН ХАБАРЛАР =====

    socket.on("message", (text) => {
      log(text);
    });

    socket.on("opponentFound", ({ opponentId }) => {
      document.getElementById("join").style.display = "none";
      document.getElementById("game").style.display = "block";
      document.getElementById("status").innerText =
        "Қарсылас табылды: " + opponentId;
    });

    socket.on("opponentBet", ({ bet }) => {
      log("Қарсылас ставка қойды: " + bet);
    });

    socket.on("opponentReady", ({ ready }) => {
      log("Қарсылас таңдады: " + (ready ? "ГОТОВ" : "ОТБОЙ"));
    });

    // ===== LOG =====
    function log(text) {
      const logDiv = document.getElementById("log");
      logDiv.innerHTML += `<div>${text}</div>`;
    }
  </script>

</body>
</html>
