<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>3 –û–π—ã–Ω—à—ã –û–π—ã–Ω</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: linear-gradient(to right, #74ebd5, #ACB6E5);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    min-height: 100vh;
    padding: 20px;
    color: #333;
  }
  h1 { margin-bottom: 10px; }
  #login, #game {
    background: white;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    width: 350px;
    text-align: center;
  }
  #game { display: none; }
  input[type=text], input[type=number] {
    width: 80%;
    padding: 8px;
    margin: 10px 0;
    border-radius: 6px;
    border: 1px solid #aaa;
    font-size: 16px;
  }
  button {
    padding: 10px 20px;
    border: none;
    border-radius: 6px;
    background: #4CAF50;
    color: white;
    font-size: 16px;
    cursor: pointer;
    margin-top: 10px;
  }
  button:hover { background: #45a049; }
  #players { margin-bottom: 10px; }
  #log { margin-top: 15px; text-align: left; height: 150px; overflow-y: auto; border: 1px solid #ccc; padding: 10px; border-radius: 6px; background: #f9f9f9; }
  #turnText { font-weight: bold; margin: 10px 0; }
</style>
</head>
<body>

<h1>3 –û–π—ã–Ω—à—ã –û–π—ã–Ω</h1>

<div id="login">
  <input type="text" id="playerName" placeholder="–ê—Ç—ã“£—ã–∑–¥—ã –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑">
  <button id="joinBtn">“ö–æ—Å—ã–ª—É</button>
</div>

<div id="game">
  <div id="players"></div>
  <div id="turnText"></div>
  <input type="number" id="choiceInput" placeholder="50‚Äì150 –∞—Ä–∞–ª—ã“ì—ã–Ω–¥–∞ —Å–∞–Ω">
  <button id="sendChoiceBtn">–ñ—ñ–±–µ—Ä—É</button>
  <div id="log"></div>
</div>

<script src="/socket.io/socket.io.js"></script>
<script>
const socket = io();

const loginDiv = document.getElementById("login");
const gameDiv = document.getElementById("game");
const playerNameInput = document.getElementById("playerName");
const joinBtn = document.getElementById("joinBtn");
const playersDiv = document.getElementById("players");
const turnText = document.getElementById("turnText");
const choiceInput = document.getElementById("choiceInput");
const sendChoiceBtn = document.getElementById("sendChoiceBtn");
const logDiv = document.getElementById("log");

let myName = "";

// “ö–æ—Å—ã–ª—É
joinBtn.addEventListener("click", () => {
  const name = playerNameInput.value.trim();
  if (!name) return alert("–ê—Ç—ã“£—ã–∑–¥—ã –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑");
  myName = name;
  socket.emit("join", name);
  loginDiv.style.display = "none";
  gameDiv.style.display = "block";
});

// –ö–æ–º–Ω–∞—Ç–∞ –∂–∞“£–∞—Ä—Ç—É
socket.on("room_update", (data) => {
  playersDiv.innerHTML = "<strong>–û–π—ã–Ω—à—ã–ª–∞—Ä:</strong><br>" + data.players.map(p => p.name).join("<br>");
});

// –û–π—ã–Ω –±–∞—Å—Ç–∞–ª–¥—ã
socket.on("game_started", (data) => {
  addLog("üî• –û–π—ã–Ω –±–∞—Å—Ç–∞–ª–¥—ã!");
});

// ”®–∑ –∫–µ–∑–µ–≥—ñ“£ –∫–µ–ª–≥–µ–Ω–¥–µ
socket.on("your_turn", (data) => {
  turnText.textContent = data.message;
  choiceInput.disabled = false;
  sendChoiceBtn.disabled = false;
  addLog("‚ö° –°–µ–Ω—ñ“£ –∫–µ–∑–µ–≥—ñ“£ –∫–µ–ª–¥—ñ!");
});

// –õ–æ–≥ –∂–∞“£–∞—Ä—Ç—É
socket.on("log_update", (data) => {
  addLog(data.msg);
});

// –ñ—ñ–±–µ—Ä—É –±–∞—Ç—ã—Ä–º–∞—Å—ã
sendChoiceBtn.addEventListener("click", () => {
  const number = parseInt(choiceInput.value);
  if (isNaN(number) || number < 50 || number > 150) return alert("50‚Äì150 –∞—Ä–∞–ª—ã“ì—ã–Ω–¥–∞ —Å–∞–Ω –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑");
  socket.emit("player_choice", { number });
  choiceInput.value = "";
  choiceInput.disabled = true;
  sendChoiceBtn.disabled = true;
  turnText.textContent = "–ö–µ–∑–µ–∫ –∫“Ø—Ç—É–¥–µ...";
});

// –õ–æ–≥“õ–∞ “õ–æ—Å—É
function addLog(msg) {
  const p = document.createElement("div");
  p.textContent = msg;
  logDiv.appendChild(p);
  logDiv.scrollTop = logDiv.scrollHeight;
}
</script>

</body>
</html>
