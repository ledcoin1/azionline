<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Azi Online</title>
<script src="/socket.io/socket.io.js"></script>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #14532d;
  color: white;
  text-align: center;
}

#lobby {
  margin-top: 60px;
}

#game {
  display: none;
  width: 900px;
  height: 550px;
  margin: 20px auto;
  background: radial-gradient(circle, #166534, #052e16);
  border-radius: 25px;
  box-shadow: 0 0 30px black;
  position: relative;
  padding-top: 20px;
}

/* “ö–∞—Ä—Å—ã–ª–∞—Å –∫–∞—Ä—Ç–∞–ª–∞—Ä—ã */
#opponent {
  margin-top: 20px;
}

.opponent-card {
  width: 90px;
  height: 140px;
  background: #eee;
  border-radius: 12px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 32px;
  margin: 5px;
  transform: rotateX(180deg);
}

/* –ú–µ–Ω—ñ“£ –∫–∞—Ä—Ç–∞–ª–∞—Ä—ã–º */
#player-cards {
  position: absolute;
  bottom: 20px;
  width: 100%;
}

.player-card {
  width: 90px;
  height: 140px;
  background: #ccc;
  border-radius: 12px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 32px;
  margin: 5px;
}

/* –°—Ç–∞–≤–∫–∞ –±–ª–æ–∫ */
#betBox {
  margin-top: 20px;
}

input[type=range] {
  width: 300px;
}

button {
  padding: 10px 18px;
  font-size: 16px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
  background: #22c55e;
  color: black;
}

button.red {
  background: #ef4444;
  color: white;
}
</style>
</head>

<body>

<h1>üÉè Azi Online</h1>

<div id="lobby">
  <div id="info">–û–π—ã–Ω“ì–∞ “õ–æ—Å—ã–ª—É</div>
  <button id="joinBtn">“ö–æ—Å—É</button>
</div>

<div id="game">
  <div id="infoGame"></div>

  <div id="opponent"></div>

  <!-- –°–¢–ê–í–ö–ê UI -->
  <div id="betBox"></div>

  <!-- –ú–ï–ù–Ü“¢ –ö–ê–†–¢–ê–õ–ê–† -->
  <div id="player-cards"></div>
</div>

<script>
const socket = io();

const joinBtn = document.getElementById("joinBtn");
const lobby = document.getElementById("lobby");
const game = document.getElementById("game");
const info = document.getElementById("info");
const infoGame = document.getElementById("infoGame");
const opponentDiv = document.getElementById("opponent");
const betBox = document.getElementById("betBox");
const playerCards = document.getElementById("player-cards");

let myRole = null;

// JOIN
joinBtn.onclick = () => {
  socket.emit("joinGame", { userId: Math.floor(Math.random() * 1000) });
  info.innerText = "–ö“Ø—Ç—ñ“£—ñ–∑...";
  joinBtn.disabled = true;
};

// MESSAGE
socket.on("message", msg => {
  info.innerText = msg;
});

// GAME START
socket.on("opponentFound", ({ opponentId }) => {
  lobby.style.display = "none";
  game.style.display = "block";
  infoGame.innerText = "“ö–∞—Ä—Å—ã–ª–∞—Å: " + opponentId;

  // “õ–∞—Ä—Å—ã–ª–∞—Å –∫–∞—Ä—Ç–∞–ª–∞—Ä—ã
  opponentDiv.innerHTML = "";
  for (let i = 0; i < 3; i++) {
    const c = document.createElement("div");
    c.className = "opponent-card";
    c.innerText = "üÇ†";
    opponentDiv.appendChild(c);
  }

  // –º–µ–Ω—ñ“£ –∫–∞—Ä—Ç–∞–ª–∞—Ä—ã–º
  playerCards.innerHTML = "";
  for (let i = 0; i < 3; i++) {
    const c = document.createElement("div");
    c.className = "player-card";
    c.innerText = "üÇ†";
    playerCards.appendChild(c);
  }

  // 1-–æ–π—ã–Ω—à—ã“ì–∞ —Å—Ç–∞–≤–∫–∞ UI
  myRole = "starter";
  showBetSelector();
});

// ===== –°–¢–ê–í–ö–ê –¢–ê“¢–î–ê–£ (1-–û–ô–´–ù–®–´) =====
function showBetSelector() {
  betBox.innerHTML = `
    <h3>–°—Ç–∞–≤–∫–∞ —Ç–∞“£–¥–∞</h3>
    <input type="range" min="25" max="150" value="25" id="betRange">
    <div id="betValue">25</div>
    <button id="betBtn">–ì–û–¢–û–í</button>
  `;

  const range = document.getElementById("betRange");
  const value = document.getElementById("betValue");

  range.oninput = () => value.innerText = range.value;

  document.getElementById("betBtn").onclick = () => {
    socket.emit("playerBet", { bet: Number(range.value) });
    betBox.innerHTML = "–°—Ç–∞–≤–∫–∞ –∂—ñ–±–µ—Ä—ñ–ª–¥—ñ...";
  };
}

// ===== 2-–û–ô–´–ù–®–´“í–ê –°–¢–ê–í–ö–ê –ö–ï–õ–ï–î–Ü =====
socket.on("opponentBet", ({ bet }) => {
  myRole = "responder";
  betBox.innerHTML = `
    <h3>–°–∞“ì–∞–Ω —Å—Ç–∞–≤–∫–∞: ${bet}</h3>
    <button id="readyBtn">–ì–û–¢–û–í</button>
    <button id="cancelBtn" class="red">–û–¢–ë–û–ô</button>
  `;

  document.getElementById("readyBtn").onclick = () => {
    socket.emit("playerReady", { ready: true });
    betBox.innerHTML = "–ö“Ø—Ç—É–¥–µ...";
  };

  document.getElementById("cancelBtn").onclick = () => {
    socket.emit("playerReady", { ready: false });
    betBox.innerHTML = "–û—Ç–±–æ–π";
  };
});
</script>

</body>
</html>
